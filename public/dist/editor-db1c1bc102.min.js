$(function(){function e(){l.l=a.getCursor().line||0,l.c=a.getCursor().ch||0,$("#cursorPanel").html(l.l+":"+l.c)}function t(){var e=document.body.clientWidth;$(".contentPanel").css({width:e/2+"px"}),$("#preview").css({left:e/2+"px",width:e/2+"px"}).show(),i()}function n(){var e=document.body.clientWidth;$(".contentPanel").css({width:e+"px"}),$("#preview").hide()}function i(){var e=a.getValue(),t=window.frames.result.document;t.open(),t.write(e),t.close()}function o(){$("#previewBtn").on("click",function(){$(this).hasClass("active")?($(this).removeClass("active"),n(),$(this).html("开启实时预览")):($(this).addClass("active"),t(),$(this).html("关闭实时预览"))})}function r(){t(),o()}var c=$("#editorPanel").get(0),s=($("#editorPanel").css("width"),$("#editorPanel").css("height")),a=CodeMirror.fromTextArea(c,{mode:"text/html",theme:"ambiance",indentUnit:4,lineNumbers:!0,lineWrapping:!0,matchBrackets:!0,styleActiveLine:!0,autoCloseTags:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchTags:{bothTags:!0}});window.editor=a,a.setSize("auto",s),a.setOption("lineWrapping",!0),$(window).keydown(function(t){e()}),$(".contentPanel").on("click",".CodeMirror",function(){e()});var l={},d=null;a.on("change",function(){window.frames.result&&(clearTimeout(d),d=setTimeout(i(),300))}),e(),r()});