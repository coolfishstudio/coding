$(function(){function e(){a.l=c.getCursor().line||0,a.c=c.getCursor().ch||0,$("#cursorPanel").html(a.l+":"+a.c)}function t(){var e=document.body.clientWidth;$(".contentPanel").css({width:e/2+"px"}),$("#preview").css({left:e/2+"px",width:e/2+"px"}).show(),i()}function n(){var e=document.body.clientWidth;$(".contentPanel").css({width:e+"px"}),$("#preview").hide()}function i(){var e=c.getValue(),t=window.frames.result.document;t.open(),t.write(e),t.close()}function o(){$("#previewBtn").on("click",function(){$(this).hasClass("active")?($(this).removeClass("active"),n(),$(this).html("开启实时预览")):($(this).addClass("active"),t(),$(this).html("关闭实时预览"))})}function r(){t(),o()}var s=$("#editorPanel").get(0),c=($("#editorPanel").css("width"),$("#editorPanel").css("height"),CodeMirror.fromTextArea(s,{mode:"text/html",theme:"ambiance",indentUnit:2,lineNumbers:!0,lineWrapping:!0,matchBrackets:!0,styleActiveLine:!0,autoCloseTags:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchTags:{bothTags:!0}}));window.editor=c,c.setSize("auto","100%"),c.setOption("lineWrapping",!0),$(window).keydown(function(t){e()}),$(".contentPanel").on("click",".CodeMirror",function(){e()});var a={},l=null;c.on("change",function(){clearTimeout(l),window.frames.result&&"none"!==$("#preview").css("display")&&(l=setTimeout(i(),300))}),c.on("keypress",function(){c.showHint()}),e(),r()});